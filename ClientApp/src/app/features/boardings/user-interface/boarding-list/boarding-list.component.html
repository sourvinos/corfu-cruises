<div id="wrapper">

    <div id="results" class="scrollable">
        <mat-sidenav-container [hasBackdrop]="true">
            <mat-sidenav mode="over" [(opened)]="openedClientFilters" position="end">
                <div *ngIf="openedClientFilters" id="clientFilters">
                    <!-- Ticket number -->
                    <mat-form-field>
                        <input type="text" matInput placeholder="{{ onGetLabel('searchLabel') }}" [(ngModel)]="searchTerm" (change)="onFilterByTicketNo(query.value)" #query autocomplete="off">
                        <mat-hint>{{ onGetLabel('searchHint') }}</mat-hint>
                        <!-- <button (click)="onFilterByTicketNo(query.value)">Search</button> -->
                    </mat-form-field>
                    <!-- Boarding status -->
                    <form id="form" [formGroup]="form" autocomplete="off">
                        <mat-form-field>
                            <mat-label>{{ onGetLabel('boardingStatus') }}</mat-label>
                            <mat-select [(value)]="boardingStatus" (selectionChange)="onFilterByBoardingStatus()">
                                <mat-option value=2>{{ onGetLabel('boardingStatusAll') }}</mat-option>
                                <mat-option value=1>{{ onGetLabel('boardingStatusBoarded') }}</mat-option>
                                <mat-option value=0>{{ onGetLabel('boardingStatusPending') }}</mat-option>
                            </mat-select>
                            <mat-hint>{{ onGetLabel('searchDropdownHint') }}</mat-hint>
                        </mat-form-field>
                        <!-- Drivers -->
                        <mat-form-field>
                            <mat-label>{{ onGetLabel("driver") }}</mat-label>
                            <mat-select [(value)]="selectedDriver" formControlName="driverId" (selectionChange)="onFilterByDriver()">
                                <mat-option *ngFor="let driver of drivers" [value]="driver.description">
                                    {{ driver.description }}
                                </mat-option>
                            </mat-select>
                            <mat-hint>{{ onGetLabel('searchDropdownHint') }}</mat-hint>
                        </mat-form-field>
                    </form>
                    <!-- Button -->
                    <button mat-flat-button class="primary" id="closeButton" (click)="close()">{{ onGetLabel('closeButton') }}</button>
                </div>
            </mat-sidenav>
            <mat-sidenav-content class="scrollable">
                <div class="record" *ngFor="let record of filteredRecords.boardings">
                    <div class="reservation">
                        <div class="field ticket">
                            <img src="/assets/images/navigation/ticket-{{theme}}.svg" width="20px">
                            <div class="field-value">{{ record.ticketNo }}</div>
                        </div>
                        <div class="field driver">
                            <img src="/assets/images/navigation/driver-{{theme}}.svg" width="20px">
                            <div class="field-value">{{ record.driver }}</div>
                        </div>
                        <div class="field customer">
                            <img src="/assets/images/navigation/customer-{{theme}}.svg" width="20px">
                            <div class="field-value">{{ record.customer }}</div>
                        </div>
                        <div class="field total-persons">
                            <img src="/assets/images/navigation/persons-{{theme}}.svg" width="20px">
                            <div class="field-value">{{ record.totalPersons }}&nbsp;</div>
                        </div>
                        <div class="field pending-persons" *ngIf="!personsAreNotMissing(record)">
                            <img src="/assets/images/navigation/danger.svg" width="20px">
                            <div class="field-value">{{ record.totalPersons - record.passengers.length }}&nbsp;</div>
                        </div>
                        <div class="field spacer"> </div>
                        <div class="field remarks" *ngIf="onCheckRemarksLength(record.remarks)" matTooltip="{{ record.remarks }}" matTooltipClass="tooltip-yellow">
                            <img src="/assets/images/navigation/warning.svg" width="25px">
                        </div>
                    </div>
                    <div class="passengers">
                        <div class="passenger" *ngFor="let passenger of record.passengers">
                            <div class="field">
                                <img *ngIf="passenger.isCheckedIn" src="/assets/images/navigation/isBoarded.svg" width="20px">
                                <img *ngIf="!passenger.isCheckedIn" src="/assets/images/navigation/isNotBoarded.svg" width="20px">
                            </div>
                            <div class="field lastname">
                                <div class="field-value">{{ passenger.lastname }}</div>
                            </div>
                            <div class="field firstname">
                                <div class="field-value">{{ passenger.firstname }}</div>
                            </div>
                            <div class="field board-passenger">
                                <button mat-flat-button class="primary" (click)="onDoBoarding(passenger.id)">{{ onGetLabel('boardButton') }}</button>
                            </div>
                        </div>
                    </div>
                </div>
            </mat-sidenav-content>
        </mat-sidenav-container>
    </div>

    <div id="footer">
        <div id="action-buttons">
            <button mat-flat-button class="primary" (click)="onShowScanner()">{{ onGetLabel('scanOpenButton') }}</button>
        </div>
        <div class="selection">
            <div class="label">{{ onGetLabel('totalPersons') }}:</div>
            <div class="sum"> {{ records.allPersons }}</div>
            <div class="label">{{ onGetLabel('boardedPersons') }}:</div>
            <div class="sum"> {{ records.boardedPersons }}</div>
            <div class="label">{{ onGetLabel('pandingPersons') }}:</div>
            <div class="sum"> {{ records.remainingPersons}} </div>
        </div>
        <div id="client-filter-buttons">
            <button mat-flat-button class="secondary" (click)="toggleClientFilters()">{{ onGetLabel('filterButton') }}</button>
        </div>
    </div>

    <div id="video">
        <qr-scanner [debug]="false" [canvasWidth]="640" [canvasHeight]="480" [stopAfterScan]="false" [updateTime]="500"></qr-scanner>
        <button mat-flat-button class="secondary" id="scanCloseButton" (click)="onHideScanner()">{{ onGetLabel('scanCloseButton') }}</button>
    </div>

</div>